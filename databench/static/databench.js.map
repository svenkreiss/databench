{"version":3,"sources":["node_modules/browser-pack/_prelude.js","js/src/connection.js","js/src/main.js","js/src/ui.js","node_modules/websocket/lib/browser.js","node_modules/websocket/lib/version.js","node_modules/websocket/package.json"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;ACAA,IAAI,OAAO,SAAP,KAAqB,WAAzB,EAAsC;;AACpC,MAAI,YAAY,QAAQ,WAAR,EAAqB,YAArC,C;AACD;;IAEY,U,WAAA,U;AACX,wBAAoE;AAAA,QAAxD,WAAwD,yDAA1C,IAA0C;AAAA,QAApC,MAAoC,yDAA3B,IAA2B;AAAA,QAArB,YAAqB,yDAAN,IAAM;;AAAA;;AAClE,SAAK,WAAL,GAAmB,WAAnB;AACA,SAAK,MAAL,GAAc,UAAU,WAAW,YAAX,EAAxB;AACA,SAAK,YAAL,GAAqB,gBAAgB,IAAhB,IAAyB,OAAO,MAAP,KAAkB,WAA5C,GACA,OAAO,QAAP,CAAgB,MADhB,GACyB,YAD7C;;AAGA,SAAK,QAAL,GAAgB;AAAA,aAAQ,OAAO,IAAP,GAAc,QAAQ,GAAR,wBAAiC,GAAjC,CAAd,GAAwD,IAAhE;AAAA,KAAhB;AACA,SAAK,YAAL,GAAoB,EAApB;AACA,SAAK,uBAAL,GAA+B,IAA/B;AACA,SAAK,mBAAL,GAA2B,EAA3B;;AAEA,SAAK,oBAAL,GAA4B,CAA5B;AACA,SAAK,kBAAL,GAA0B,KAA1B;;AAEA,SAAK,MAAL,GAAc,IAAd;AACA,SAAK,iBAAL,GAAyB,IAAzB;;;AAGA,SAAK,OAAL,GAAe,KAAK,OAAL,CAAa,IAAb,CAAkB,IAAlB,CAAf;AACA,SAAK,aAAL,GAAqB,KAAK,aAAL,CAAmB,IAAnB,CAAwB,IAAxB,CAArB;AACA,SAAK,SAAL,GAAiB,KAAK,SAAL,CAAe,IAAf,CAAoB,IAApB,CAAjB;AACA,SAAK,UAAL,GAAkB,KAAK,UAAL,CAAgB,IAAhB,CAAqB,IAArB,CAAlB;AACA,SAAK,YAAL,GAAoB,KAAK,YAAL,CAAkB,IAAlB,CAAuB,IAAvB,CAApB;AACA,SAAK,qBAAL,GAA6B,KAAK,qBAAL,CAA2B,IAA3B,CAAgC,IAAhC,CAA7B;AACA,SAAK,EAAL,GAAU,KAAK,EAAL,CAAQ,IAAR,CAAa,IAAb,CAAV;AACA,SAAK,IAAL,GAAY,KAAK,IAAL,CAAU,IAAV,CAAe,IAAf,CAAZ;AACA,SAAK,SAAL,GAAiB,KAAK,SAAL,CAAe,IAAf,CAAoB,IAApB,CAAjB;AACD;;;;8BAUS;AACR,WAAK,MAAL,GAAc,IAAI,SAAJ,CAAc,KAAK,MAAnB,CAAd,C;;AAEA,WAAK,iBAAL,GAAyB,YAAY,KAAK,aAAjB,EAAgC,IAAhC,CAAzB;AACA,WAAK,MAAL,CAAY,MAAZ,GAAqB,KAAK,SAA1B;AACA,WAAK,MAAL,CAAY,OAAZ,GAAsB,KAAK,UAA3B;AACA,WAAK,MAAL,CAAY,SAAZ,GAAwB,KAAK,YAA7B;AACA,aAAO,IAAP;AACD;;;oCAEe;AACd,UAAI,KAAK,MAAL,CAAY,UAAZ,KAA2B,KAAK,MAAL,CAAY,UAA3C,EAAuD;AACrD;AACD;AACD,UAAI,KAAK,MAAL,CAAY,UAAZ,KAA2B,KAAK,MAAL,CAAY,IAA3C,EAAiD;AAC/C,aAAK,QAAL,CACE,qCACA,qDADA,GAEA,uDAHF;AAKD;AACD,oBAAc,KAAK,iBAAnB;AACD;;;gCAEW;AACV,WAAK,oBAAL,GAA4B,CAA5B;AACA,WAAK,kBAAL,GAA0B,KAA1B;AACA,WAAK,QAAL,G;AACA,WAAK,MAAL,CAAY,IAAZ,CAAiB,KAAK,SAAL,CAAe;AAC9B,mBAAW,KAAK,WADc;AAE9B,wBAAgB,KAAK;AAFS,OAAf,CAAjB;AAID;;;iCAEY;AACX,oBAAc,KAAK,iBAAnB;;AAEA,WAAK,oBAAL,IAA6B,CAA7B;AACA,WAAK,kBAAL,IAA2B,CAA3B;;AAEA,UAAI,KAAK,oBAAL,GAA4B,CAAhC,EAAmC;AACjC,aAAK,QAAL,CACE,wBACA,qDADA,GAEA,uDAHF;AAKA;AACD;;AAED,UAAM,eAAe,MAAM,KAAK,kBAAX,GAAgC,MAAM,KAAK,MAAL,EAAN,GAChC,KAAK,kBAD1B;AAEA,cAAQ,GAAR,CAAY,iCAA+B,KAAK,oBAApC,kBACM,aAAa,OAAb,CAAqB,CAArB,CADN,SAAZ;AAEA,iBAAW,KAAK,OAAhB,EAAyB,YAAzB;AACD;;;iCAEY,K,EAAO;AAAA;;AAClB,UAAM,UAAU,KAAK,KAAL,CAAW,MAAM,IAAjB,CAAhB;;;AAGA,UAAI,QAAQ,MAAR,KAAmB,WAAvB,EAAoC;AAClC,aAAK,WAAL,GAAmB,QAAQ,IAAR,CAAa,WAAhC;AACD;;;AAGD,UAAI,QAAQ,MAAR,KAAmB,WAAvB,EAAoC;AAAA;AAClC,cAAM,KAAK,QAAQ,IAAR,CAAa,EAAxB;AACA,cAAM,SAAS,QAAQ,IAAR,CAAa,MAA5B;AACA,gBAAK,mBAAL,CAAyB,EAAzB,EAA6B,GAA7B,CAAiC;AAAA,mBAAM,GAAG,MAAH,CAAN;AAAA,WAAjC;AAHkC;AAInC;;;AAGD,UAAI,KAAK,uBAAL,KAAiC,IAArC,EAA2C,KAAK,qBAAL;AAC3C,UAAI,QAAQ,MAAR,IAAkB,KAAK,uBAA3B,EAAoD;AAClD,aAAK,uBAAL,CAA6B,QAAQ,MAArC,EAA6C,GAA7C,CAAiD;AAAA,iBAAM,GAAG,QAAQ,IAAX,CAAN;AAAA,SAAjD;AACD;AACF;;;4CAEuB;AAAA;;AACtB,WAAK,uBAAL,GAA+B,EAA/B;AACA,WAAK,YAAL,CAAkB,OAAlB,CAA0B,gBAA0B;AAAA,YAAvB,MAAuB,QAAvB,MAAuB;AAAA,YAAf,QAAe,QAAf,QAAe;;AAClD,YAAI,OAAO,MAAP,KAAkB,QAAtB,EAAgC;AAC9B,cAAI,EAAE,UAAU,OAAK,uBAAjB,CAAJ,EAA+C;AAC7C,mBAAK,uBAAL,CAA6B,MAA7B,IAAuC,EAAvC;AACD;AACD,iBAAK,uBAAL,CAA6B,MAA7B,EAAqC,IAArC,CAA0C,QAA1C;AACD,SALD,MAKO,IAAI,QAAO,MAAP,yCAAO,MAAP,OAAkB,QAAtB,EAAgC;AACrC,iBAAO,IAAP,CAAY,MAAZ,EAAoB,OAApB,CAA4B,sBAAc;AACxC,gBAAM,YAAY,OAAO,UAAP,CAAlB;AACA,gBAAM,oBAAoB,SAApB,iBAAoB,OAAQ;AAChC,kBAAI,KAAK,cAAL,CAAoB,SAApB,CAAJ,EAAoC;AAClC,yBAAS,KAAK,SAAL,CAAT;AACD;AACF,aAJD;;AAMA,gBAAI,EAAE,cAAc,OAAK,uBAArB,CAAJ,EAAmD;AACjD,qBAAK,uBAAL,CAA6B,UAA7B,IAA2C,EAA3C;AACD;;;AAGD,gBAAI,SAAJ,EAAe;AACb,qBAAK,uBAAL,CAA6B,UAA7B,EAAyC,IAAzC,CAA8C,iBAA9C;AACD,aAFD,MAEO;AACL,qBAAK,uBAAL,CAA6B,UAA7B,EAAyC,IAAzC,CAA8C,QAA9C;AACD;AACF,WAlBD;AAmBD;AACF,OA3BD;AA4BD;;;uBAEE,M,EAAQ,Q,EAAU;AACnB,WAAK,YAAL,CAAkB,IAAlB,CAAuB,EAAE,cAAF,EAAU,kBAAV,EAAvB;AACA,WAAK,uBAAL,GAA+B,IAA/B;AACA,aAAO,IAAP;AACD;;;yBAEI,U,EAAY,O,EAAS;AAAA;;AACxB,UAAI,KAAK,MAAL,IAAe,IAAf,IAAuB,KAAK,MAAL,CAAY,UAAZ,KAA2B,KAAK,MAAL,CAAY,IAAlE,EAAwE;AACtE,mBAAW;AAAA,iBAAM,OAAK,IAAL,CAAU,UAAV,EAAsB,OAAtB,CAAN;AAAA,SAAX,EAAiD,CAAjD;AACA,eAAO,IAAP;AACD;AACD,WAAK,MAAL,CAAY,IAAZ,CAAiB,KAAK,SAAL,CAAe,EAAE,QAAQ,UAAV,EAAsB,MAAM,OAA5B,EAAf,CAAjB;AACA,aAAO,IAAP;AACD;;;8BAES,S,EAAW,Q,EAAU;AAC7B,UAAI,EAAE,aAAa,KAAK,mBAApB,CAAJ,EAA8C;AAC5C,aAAK,mBAAL,CAAyB,SAAzB,IAAsC,EAAtC;AACD;AACD,WAAK,mBAAL,CAAyB,SAAzB,EAAoC,IAApC,CAAyC,QAAzC;AACA,aAAO,IAAP;AACD;;;mCA3IqB;AACpB,UAAI,cAAc,IAAlB;AACA,UAAI,SAAS,MAAT,CAAgB,UAAhB,CAA2B,UAA3B,CAAJ,EAA4C,cAAc,KAAd;;AAE5C,UAAM,OAAO,SAAS,QAAT,CAAkB,SAAlB,CAA4B,CAA5B,EAA+B,SAAS,QAAT,CAAkB,WAAlB,CAA8B,GAA9B,CAA/B,CAAb;AACA,aAAU,WAAV,WAA2B,SAAS,MAApC,SAA8C,SAAS,IAAvD,GAA8D,IAA9D;AACD;;;;;;;;;;;;;;ACxCH;;IAAY,E;;AACZ;;;;;AAGA,IAAI,OAAO,MAAP,KAAkB,WAAtB,EAAmC;AACjC,SAAO,SAAP,GAAmB,EAAE,MAAF,EAAM,kCAAN,EAAnB;AACD;QACQ,E,GAAA,E;QAAI,U;;;;;;;;;;;;;QCiXG,I,GAAA,I;;;;;;;;;;IAvXV,S;AACJ,qBAAY,IAAZ,EAAkB;AAAA;;AAChB,SAAK,IAAL,GAAY,IAAZ;AACA,SAAK,IAAL,CAAU,YAAV,GAAyB,IAAzB;;AAEA,SAAK,WAAL,GAAmB,UAAU,qBAAV,CAAgC,IAAhC,CAAnB;AACA,SAAK,aAAL,GAAqB;AAAA,aAAS,KAAT;AAAA,KAArB;;AAEA,SAAK,WAAL,GAAmB,EAAE,MAAM,KAAK,WAAb,EAAnB;AACD;;;;0CAE4B,I,EAAM;;AAEjC,UAAI,SAAS,IAAb;;AAEA,UAAI,KAAK,OAAL,CAAa,QAAb,KAA0B,MAA1B,IACF,KAAK,OAAL,CAAa,QAAb,KAA0B,MADxB,IAEF,KAAK,OAAL,CAAa,QAAb,KAA0B,GAF5B,EAEiC;AAC/B,eAAO,IAAP;AACD;;AAED,UAAI,KAAK,OAAL,CAAa,MAAjB,EAAyB;AACvB,iBAAS,KAAK,OAAL,CAAa,MAAtB;AACD,OAFD,MAEO,IAAI,KAAK,YAAL,CAAkB,MAAlB,CAAJ,EAA+B;AACpC,iBAAS,KAAK,YAAL,CAAkB,MAAlB,CAAT;AACD,OAFM,MAEA,IAAI,KAAK,YAAL,CAAkB,IAAlB,CAAJ,EAA6B;AAClC,iBAAS,KAAK,YAAL,CAAkB,IAAlB,CAAT;AACD;;AAED,aAAO,MAAP;AACD;;;;;;IAGU,G,WAAA,G;;;AACX,eAAY,IAAZ,EAAyE;AAAA,QAAvD,aAAuD,yDAAvC,KAAuC;AAAA,QAAhC,KAAgC,yDAAxB,EAAwB;AAAA,QAApB,YAAoB,yDAAL,GAAK;;AAAA;;AAAA,uFACjE,IADiE;;AAGvE,UAAK,aAAL,GAAqB,aAArB;AACA,UAAK,KAAL,GAAa,KAAb;AACA,UAAK,YAAL,GAAoB,YAApB;AACA,UAAK,SAAL,GAAiB,EAAjB;;;AAGA,UAAK,WAAL,GAAmB,EAAE,KAAK,IAAP,EAAnB;;;AAGA,UAAK,MAAL,GAAc,MAAK,MAAL,CAAY,IAAZ,OAAd;AACA,UAAK,GAAL,GAAW,MAAK,GAAL,CAAS,IAAT,OAAX;;;AAGA,QAAM,qBAAqB,QAAQ,aAAR,CAA3B;AACA,YAAQ,aAAR,IAAyB,mBAAW;AAClC,YAAK,GAAL,CAAS,OAAT,EAAkB,UAAlB;AACA,yBAAmB,KAAnB,CAAyB,OAAzB,EAAkC,CAAC,OAAD,CAAlC;AACD,KAHD;AAjBuE;AAqBxE;;;;6BAEQ;AAAA;;AACP,aAAO,KAAK,SAAL,CAAe,MAAf,GAAwB,KAAK,KAApC;AAA2C,aAAK,SAAL,CAAe,KAAf;AAA3C,OAEA,KAAK,IAAL,CAAU,SAAV,GAAsB,KAAK,SAAL,CACnB,GADmB,CACf;AAAA,eAAK,EAAE,IAAF,CAAO,EAAP,CAAL;AAAA,OADe,EAEnB,GAFmB,CAEf;AAAA,eAAO,EAAE,MAAF,GAAW,OAAK,YAAjB,GACK,EAAE,MAAF,CAAS,CAAT,EAAY,OAAK,YAAjB,CADL,YAEE,CAFR;AAAA,OAFe,EAKnB,IALmB,CAKd,IALc,CAAtB;;AAOA,aAAO,IAAP;AACD;;;wBAEG,O,EAA6B;AAAA,UAApB,MAAoB,yDAAX,SAAW;;AAC/B,UAAM,MAAM,OAAO,OAAP,KAAmB,QAAnB,GAA8B,OAA9B,GAAwC,KAAK,SAAL,CAAe,OAAf,CAApD;AACA,UAAM,gBAAgB,IAAI,MAAJ,CAAW,KAAK,GAAL,CAAS,CAAT,EAAY,IAAI,OAAO,MAAvB,CAAX,IAA6C,MAAnE;AACA,WAAK,SAAL,CAAe,IAAf,CAAoB,CAAI,aAAJ,UAAsB,GAAtB,CAApB;AACA,WAAK,MAAL;AACA,aAAO,IAAP;AACD;;;yBAEW,I,EACgC;AAAA,UAD1B,EAC0B,yDADrB,KACqB;AAAA,UADd,MACc,yDADL,SACK;AAAA,UADM,aACN,yDADsB,KACtB;AAAA,UAAhC,KAAgC,yDAAxB,EAAwB;AAAA,UAApB,YAAoB,yDAAL,GAAK;;AAC1C,UAAM,OAAO,SAAS,cAAT,CAAwB,EAAxB,CAAb;AACA,UAAI,QAAQ,IAAZ,EAAkB,OAAO,IAAP;;AAElB,cAAQ,GAAR,wBAAiC,EAAjC;AACA,UAAM,IAAI,IAAI,GAAJ,CAAQ,IAAR,EAAc,aAAd,EAA6B,KAA7B,EAAoC,YAApC,CAAV;AACA,WAAK,EAAL,CAAQ,EAAE,WAAV,EAAuB;AAAA,eAAW,EAAE,GAAF,CAAM,OAAN,EAAe,MAAf,CAAX;AAAA,OAAvB;AACA,aAAO,IAAP;AACD;;;;EAtDsB,S;;IA0DZ,S,WAAA,S;;;AACX,qBAAY,IAAZ,EAAuD;AAAA,QAArC,SAAqC,yDAAzB,UAAU,aAAe;;AAAA;;AAAA,8FAC/C,IAD+C;;AAGrD,WAAK,SAAL,GAAiB,SAAjB;AACA,WAAK,SAAL,GAAiB,IAAI,GAAJ,EAAjB;;;AAGA,WAAK,WAAL,GAAmB,IAAnB;;;AAGA,WAAK,MAAL,GAAc,OAAK,MAAL,CAAY,IAAZ,QAAd;AACA,WAAK,GAAL,GAAW,OAAK,GAAL,CAAS,IAAT,QAAX;AAXqD;AAYtD;;;;6BAOQ;AAAA;;AACP,UAAM,YAAY,6BAAI,KAAK,SAAT,GAAoB,GAApB,CAAwB;AAAA;;AAAA,YAAE,CAAF;AAAA,YAAK,CAAL;AAAA,eAAY,OAAK,SAAL,CAAe,CAAf,EAAkB,CAAlB,CAAZ;AAAA,OAAxB,CAAlB;AACA,WAAK,IAAL,CAAU,SAAV,GAAsB,UAAU,IAAV,CAAe,IAAf,CAAtB;AACA,aAAO,IAAP;AACD;;;wBAEG,O,EAAS;AACX,UAAI,WAAW,IAAf,EAAqB;AACnB,aAAK,SAAL,CAAe,KAAf;AACA,eAAO,IAAP;AACD;AACD,UAAM,MAAM,OAAO,OAAP,KAAmB,QAAnB,GAA8B,OAA9B,GAAwC,KAAK,SAAL,CAAe,OAAf,CAApD;;AAEA,UAAI,KAAK,SAAL,CAAe,GAAf,CAAmB,GAAnB,CAAJ,EAA6B;AAC3B,aAAK,SAAL,CAAe,GAAf,CAAmB,GAAnB,EAAwB,KAAK,SAAL,CAAe,GAAf,CAAmB,GAAnB,IAA0B,CAAlD;AACD,OAFD,MAEO;AACL,aAAK,SAAL,CAAe,GAAf,CAAmB,GAAnB,EAAwB,CAAxB;AACD;AACD,WAAK,MAAL;AACA,aAAO,IAAP;AACD;;;kCAzBoB,G,EAAK,K,EAAO;AAC/B,UAAM,eAAe,SAAS,CAAT,GAAa,EAAb,YAAyB,KAAzB,WAArB;AACA,kDAA0C,YAA1C,GAAyD,GAAzD;AACD;;;yBAwBW,I,EAA6D;AAAA,UAAvD,EAAuD,yDAAlD,WAAkD;AAAA,UAArC,SAAqC,yDAAzB,UAAU,aAAe;;AACvE,UAAM,OAAO,SAAS,cAAT,CAAwB,EAAxB,CAAb;AACA,UAAI,QAAQ,IAAZ,EAAkB;;AAElB,cAAQ,GAAR,wBAAiC,EAAjC;AACA,UAAM,IAAI,IAAI,SAAJ,CAAc,IAAd,EAAoB,SAApB,CAAV;AACA,WAAK,QAAL,GAAgB,EAAE,GAAlB;AACD;;;;EAjD4B,S;;IAqDlB,M,WAAA,M;;;AACX,kBAAY,IAAZ,EAAkB;AAAA;;AAAA,2FACV,IADU;;AAGhB,WAAK,IAAL,GAAY,CAAZ;AACA,WAAK,MAAL,GAAc,CAAd;;AAEA,WAAK,QAAL,GAAgB,UAAC,SAAD;AAAA,aAAe,QAAQ,GAAR,eAAwB,OAAK,IAA7B,cAA0C,SAA1C,CAAf;AAAA,KAAhB;AACA,WAAK,MAAL,GAAc,OAAK,IAAnB;;;AAGA,WAAK,MAAL,GAAc,OAAK,MAAL,CAAY,IAAZ,QAAd;AACA,WAAK,KAAL,GAAa,OAAK,KAAL,CAAW,IAAX,QAAb;AACA,WAAK,KAAL,GAAa,OAAK,KAAL,CAAW,IAAX,QAAb;;AAEA,WAAK,IAAL,CAAU,gBAAV,CAA2B,OAA3B,EAAoC,OAAK,KAAzC,EAAgD,KAAhD;AAdgB;AAejB;;;;6BAEQ;AACP,cAAQ,KAAK,MAAb;AACE,aAAK,KAAK,MAAV;AACE,eAAK,IAAL,CAAU,SAAV,CAAoB,GAApB,CAAwB,UAAxB;AACA;AACF;AACE,eAAK,IAAL,CAAU,SAAV,CAAoB,MAApB,CAA2B,UAA3B;AALJ;AAOA,aAAO,IAAP;AACD;;;4BAEO;AACN,UAAI,KAAK,MAAL,KAAgB,KAAK,IAAzB,EAA+B,OAAO,IAAP;;AAE/B,UAAM,YAAY,KAAK,KAAL,CAAW,KAAK,MAAL,KAAgB,QAA3B,CAAlB;AACA,WAAK,QAAL,CAAc,SAAd;AACA,aAAO,IAAP;AACD;;;0BAEK,C,EAAG;AACP,UAAI,MAAM,KAAK,IAAX,IAAmB,MAAM,KAAK,MAAlC,EAA0C,OAAO,IAAP;;AAE1C,WAAK,MAAL,GAAc,CAAd;AACA,WAAK,MAAL;AACA,aAAO,IAAP;AACD;;;yBAEW,I,EAAM;AAChB,YAAM,IAAN,CAAW,SAAS,oBAAT,CAA8B,QAA9B,CAAX,EACG,MADH,CACU;AAAA,eAAQ,KAAK,YAAL,KAAsB,SAA9B;AAAA,OADV,EAEG,OAFH,CAEW,gBAAQ;AACf,YAAM,IAAI,IAAI,MAAJ,CAAW,IAAX,CAAV;AACA,gBAAQ,GAAR,oBAA6B,IAA7B,mBAA+C,EAAE,WAAjD;;;AAGA,UAAE,QAAF,GAAa,UAAC,SAAD,EAAe;;AAE1B,eAAK,SAAL,CAAe,SAAf,EAA0B;AAAA,mBAAU,EAAE,KAAF;;AAElC,cAAE,OAAO,EAAE,MAAX,EAAmB,KAAK,EAAE,IAA1B,GAAiC,MAAjC,CAFkC,CAAV;AAAA,WAA1B;;AAKA,eAAK,IAAL,CAAU,EAAE,WAAZ,EAAyB,EAAE,aAAF,CAAgB,EAAE,cAAc,SAAhB,EAAhB,CAAzB;AACD,SARD;AASD,OAhBH;AAiBD;;;;EA/DyB,S;;IAmEf,I,WAAA,I;;;AACX,gBAAY,IAAZ,EAAkB;AAAA;;AAAA,yFACV,IADU;;AAGhB,WAAK,SAAL,GAAiB;AAAA,aAAS,KAAT;AAAA,KAAjB;;;AAGA,WAAK,KAAL,GAAa,OAAK,KAAL,CAAW,IAAX,QAAb;AANgB;AAOjB;;;;0BAEK,C,EAAG;;AAEP,UAAI,MAAM,SAAV,EAAqB,OAAO,KAAK,IAAL,CAAU,SAAjB;;AAErB,WAAK,IAAL,CAAU,SAAV,GAAsB,KAAK,SAAL,CAAe,KAAK,EAApB,CAAtB;AACA,aAAO,IAAP;AACD;;;yBAEW,I,EAAM;AAChB,mCAAI,MAAM,IAAN,CAAW,SAAS,oBAAT,CAA8B,MAA9B,CAAX,CAAJ,sBACI,MAAM,IAAN,CAAW,SAAS,oBAAT,CAA8B,GAA9B,CAAX,CADJ,sBAEI,MAAM,IAAN,CAAW,SAAS,oBAAT,CAA8B,KAA9B,CAAX,CAFJ,sBAGI,MAAM,IAAN,CAAW,SAAS,oBAAT,CAA8B,GAA9B,CAAX,CAHJ,sBAII,MAAM,IAAN,CAAW,SAAS,oBAAT,CAA8B,GAA9B,CAAX,CAJJ,GAKG,MALH,CAKU;AAAA,eAAQ,KAAK,YAAL,KAAsB,SAA9B;AAAA,OALV,EAMG,MANH,CAMU;AAAA,eAAQ,KAAK,OAAL,CAAa,MAAb,KAAwB,SAAhC;AAAA,OANV,EAOG,MAPH,CAOU;AAAA,eAAQ,UAAU,qBAAV,CAAgC,IAAhC,MAA0C,IAAlD;AAAA,OAPV,EAQG,OARH,CAQW,gBAAQ;AACf,YAAM,IAAI,IAAI,IAAJ,CAAS,IAAT,CAAV;AACA,gBAAQ,GAAR,kBAA2B,IAA3B,mBAA6C,EAAE,WAA/C;;;AAGA,aAAK,EAAL,CAAQ,EAAE,WAAV,EAAuB;AAAA,iBAAW,EAAE,KAAF,CAAQ,OAAR,CAAX;AAAA,SAAvB;AACD,OAdH;AAeD;;;;EAlCuB,S;;IAsCb,S,WAAA,S;;;AACX,qBAAY,IAAZ,EAAkB;AAAA;;AAAA,8FACV,IADU;;AAGhB,WAAK,gBAAL,GAAwB,KAAxB;AACA,WAAK,SAAL,GAAiB;AAAA,aAAS,KAAT;AAAA,KAAjB;AACA,WAAK,SAAL,GAAiB;AAAA,aAAS,QAAQ,GAAR,gBAAyB,OAAK,IAA9B,UAAuC,KAAvC,CAAT;AAAA,KAAjB;;;AAGA,WAAK,MAAL,GAAc,OAAK,MAAL,CAAY,IAAZ,QAAd;AACA,WAAK,KAAL,GAAa,OAAK,KAAL,CAAW,IAAX,QAAb;AACA,WAAK,KAAL,GAAa,OAAK,KAAL,CAAW,IAAX,QAAb;;AAEA,WAAK,IAAL,CAAU,gBAAV,CAA2B,QAA3B,EAAqC,OAAK,MAA1C,EAAkD,KAAlD;AACA,WAAK,IAAL,CAAU,gBAAV,CAA2B,OAA3B,EAAoC,OAAK,KAAzC,EAAgD,KAAhD;AAbgB;AAcjB;;;;6BAEQ;AACP,aAAO,KAAK,SAAL,CAAe,KAAK,aAAL,CAAmB,KAAK,KAAL,EAAnB,CAAf,CAAP;AACD;;;4BAEO;AACN,UAAI,KAAK,gBAAT,EAA2B,KAAK,MAAL;AAC5B;;;0BAEK,C,EAAG;;AAEP,UAAI,MAAM,SAAV,EAAqB,OAAO,KAAK,IAAL,CAAU,KAAjB;;AAErB,WAAK,IAAL,CAAU,KAAV,GAAkB,KAAK,SAAL,CAAe,KAAK,EAApB,CAAlB;AACA,aAAO,IAAP;AACD;;;yBAEW,I,EAAM;AAChB,YAAM,IAAN,CAAW,SAAS,oBAAT,CAA8B,OAA9B,CAAX,EACG,MADH,CACU;AAAA,eAAQ,KAAK,YAAL,KAAsB,SAA9B;AAAA,OADV,EAEG,MAFH,CAEU;AAAA,eAAQ,KAAK,YAAL,CAAkB,MAAlB,MAA8B,MAAtC;AAAA,OAFV,EAGG,OAHH,CAGW,gBAAQ;AACf,YAAM,IAAI,IAAI,SAAJ,CAAc,IAAd,CAAV;AACA,gBAAQ,GAAR,wBAAiC,IAAjC,mBAAmD,EAAE,WAArD;;;AAGA,UAAE,SAAF,GAAc;AAAA,iBAAW,KAAK,IAAL,CAAU,EAAE,WAAZ,EAAyB,OAAzB,CAAX;AAAA,SAAd;;;AAGA,aAAK,EAAL,CAAQ,EAAE,WAAV,EAAuB;AAAA,iBAAW,EAAE,KAAF,CAAQ,OAAR,CAAX;AAAA,SAAvB;AACD,OAZH;AAaD;;;;EA/C4B,S;;IAmDlB,M,WAAA,M;;;AACX,kBAAY,IAAZ,EAAkB,UAAlB,EAA8B;AAAA;;AAAA,2FACtB,IADsB;;AAG5B,WAAK,UAAL,GAAkB,UAAlB;AACA,WAAK,UAAL,GAAkB,aAAa,WAAW,SAAxB,GAAoC,IAAtD;AACA,WAAK,SAAL,GAAiB;AAAA,aAAS,QAAQ,GAAR,2BAAoC,KAApC,CAAT;AAAA,KAAjB;AACA,WAAK,eAAL,GAAuB;AAAA,aAAS,KAAT;AAAA,KAAvB;AACA,WAAK,eAAL,GAAuB;AAAA,aAAK,CAAL;AAAA,KAAvB;AACA,WAAK,SAAL,GAAiB;AAAA,aAAS,KAAT;AAAA,KAAjB;;;AAGA,WAAK,MAAL,GAAc,OAAK,MAAL,CAAY,IAAZ,QAAd;AACA,WAAK,KAAL,GAAa,OAAK,KAAL,CAAW,IAAX,QAAb;AACA,WAAK,MAAL,GAAc,OAAK,MAAL,CAAY,IAAZ,QAAd;;AAEA,WAAK,IAAL,CAAU,gBAAV,CAA2B,OAA3B,EAAoC,OAAK,MAAzC,EAAiD,KAAjD;AACA,WAAK,IAAL,CAAU,gBAAV,CAA2B,QAA3B,EAAqC,OAAK,MAA1C,EAAkD,KAAlD;AACA,WAAK,MAAL;AAjB4B;AAkB7B;;;;6BAEQ;AACP,UAAM,IAAI,KAAK,KAAL,EAAV;AACA,UAAI,KAAK,UAAT,EAAqB;AACnB,aAAK,UAAL,CAAgB,SAAhB,GAA+B,KAAK,UAApC,SAAkD,KAAK,SAAL,CAAe,CAAf,CAAlD;AACD;AACD,aAAO,IAAP;AACD;;;0BAEK,C,EAAG;;AAEP,UAAI,MAAM,SAAV,EAAqB;AACnB,eAAO,KAAK,eAAL,CAAqB,WAAW,KAAK,IAAL,CAAU,KAArB,CAArB,CAAP;AACD;;AAED,UAAM,mBAAmB,KAAK,eAAL,CAAqB,CAArB,CAAzB;AACA,UAAI,KAAK,IAAL,CAAU,KAAV,KAAoB,gBAAxB,EAA0C,OAAO,IAAP;;AAE1C,WAAK,IAAL,CAAU,KAAV,GAAkB,gBAAlB;AACA,WAAK,MAAL;AACA,aAAO,IAAP;AACD;;;6BAEQ;AACP,aAAO,KAAK,SAAL,CAAe,KAAK,aAAL,CAAmB,KAAK,KAAL,EAAnB,CAAf,CAAP;AACD;;;wCAE0B;AACzB,YAAM,IAAN,CAAW,SAAS,oBAAT,CAA8B,OAA9B,CAAX,EACG,MADH,CACU;AAAA,eAAS,MAAM,OAAf;AAAA,OADV,EAEG,OAFH,CAEW,iBAAS;AAChB,YAAM,OAAO,SAAS,cAAT,CAAwB,MAAM,OAA9B,CAAb;AACA,YAAI,IAAJ,EAAU,KAAK,KAAL,GAAa,KAAb;AACX,OALH;AAMD;;;yBAEW,I,EAAM;AAChB,WAAK,iBAAL;;AAEA,YAAM,IAAN,CAAW,SAAS,oBAAT,CAA8B,OAA9B,CAAX,EACG,MADH,CACU;AAAA,eAAQ,KAAK,YAAL,KAAsB,SAA9B;AAAA,OADV,EAEG,MAFH,CAEU;AAAA,eAAQ,KAAK,YAAL,CAAkB,MAAlB,MAA8B,OAAtC;AAAA,OAFV,EAGG,OAHH,CAGW,gBAAQ;AACf,YAAM,SAAS,IAAI,MAAJ,CAAW,IAAX,EAAiB,KAAK,KAAtB,CAAf;AACA,gBAAQ,GAAR,oBAA6B,IAA7B,mBAA+C,OAAO,WAAtD;;;AAGA,eAAO,SAAP,GAAmB;AAAA,iBAAW,KAAK,IAAL,CAAU,OAAO,WAAjB,EAA8B,OAA9B,CAAX;AAAA,SAAnB;;;AAGA,aAAK,EAAL,CAAQ,OAAO,WAAf,EAA4B;AAAA,iBAAW,OAAO,KAAP,CAAa,OAAb,CAAX;AAAA,SAA5B;AACD,OAZH;AAaD;;;;EAxEyB,S;;AA2ErB,SAAS,IAAT,CAAc,UAAd,EAA0B;AAC/B,YAAU,IAAV,CAAe,UAAf;AACA,MAAI,IAAJ,CAAS,UAAT;AACA,SAAO,IAAP,CAAY,UAAZ;AACA,YAAU,IAAV,CAAe,UAAf;AACA,OAAK,IAAL,CAAU,UAAV;AACA,SAAO,IAAP,CAAY,UAAZ;AACA,SAAO,UAAP;AACD;;;AChYD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"databench.js","sourceRoot":"/source/","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","if (typeof WebSocket === 'undefined') {  // eslint-disable-line\n  var WebSocket = require('websocket').w3cwebsocket;  // eslint-disable-line\n}\n\nexport class Connection {\n  constructor(analysis_id = null, ws_url = null, request_args = null) {\n    this.analysis_id = analysis_id;\n    this.ws_url = ws_url || Connection.guess_ws_url();\n    this.request_args = (request_args == null && (typeof window !== 'undefined')) ?\n                        window.location.search : request_args;\n\n    this.error_cb = msg => (msg != null ? console.log(`connection error: ${msg}`) : null);\n    this.on_callbacks = [];\n    this._on_callbacks_optimized = null;\n    this.onProcess_callbacks = {};\n\n    this.ws_reconnect_attempt = 0;\n    this.ws_reconnect_delay = 100.0;\n\n    this.socket = null;\n    this.socket_check_open = null;\n\n    // bind methods\n    this.connect = this.connect.bind(this);\n    this.ws_check_open = this.ws_check_open.bind(this);\n    this.ws_onopen = this.ws_onopen.bind(this);\n    this.ws_onclose = this.ws_onclose.bind(this);\n    this.ws_onmessage = this.ws_onmessage.bind(this);\n    this.optimize_on_callbacks = this.optimize_on_callbacks.bind(this);\n    this.on = this.on.bind(this);\n    this.emit = this.emit.bind(this);\n    this.onProcess = this.onProcess.bind(this);\n  }\n\n  static guess_ws_url() {\n    let ws_protocol = 'ws';\n    if (location.origin.startsWith('https://')) ws_protocol = 'wss';\n\n    const path = location.pathname.substring(0, location.pathname.lastIndexOf('/'));\n    return `${ws_protocol}://${document.domain}:${location.port}${path}/ws`;\n  }\n\n  connect() {\n    this.socket = new WebSocket(this.ws_url);  // eslint-disable-line\n\n    this.socket_check_open = setInterval(this.ws_check_open, 2000);\n    this.socket.onopen = this.ws_onopen;\n    this.socket.onclose = this.ws_onclose;\n    this.socket.onmessage = this.ws_onmessage;\n    return this;\n  }\n\n  ws_check_open() {\n    if (this.socket.readyState === this.socket.CONNECTING) {\n      return;\n    }\n    if (this.socket.readyState !== this.socket.OPEN) {\n      this.error_cb(\n        'Connection could not be opened. ' +\n        'Please <a href=\"javascript:location.reload(true);\" ' +\n        'class=\"alert-link\">reload</a> this page to try again.'\n      );\n    }\n    clearInterval(this.socket_check_open);\n  }\n\n  ws_onopen() {\n    this.ws_reconnect_attempt = 0;\n    this.ws_reconnect_delay = 100.0;\n    this.error_cb();  // clear errors\n    this.socket.send(JSON.stringify({\n      __connect: this.analysis_id,\n      __request_args: this.request_args,\n    }));\n  }\n\n  ws_onclose() {\n    clearInterval(this.socket_check_open);\n\n    this.ws_reconnect_attempt += 1;\n    this.ws_reconnect_delay *= 2;\n\n    if (this.ws_reconnect_attempt > 3) {\n      this.error_cb(\n        'Connection closed. ' +\n        'Please <a href=\"javascript:location.reload(true);\" ' +\n        'class=\"alert-link\">reload</a> this page to reconnect.'\n      );\n      return;\n    }\n\n    const actual_delay = 0.7 * this.ws_reconnect_delay + 0.3 * Math.random() *\n                         this.ws_reconnect_delay;\n    console.log(`WebSocket reconnect attempt ${this.ws_reconnect_attempt} ` +\n                `in ${actual_delay.toFixed(0)}ms.`);\n    setTimeout(this.connect, actual_delay);\n  }\n\n  ws_onmessage(event) {\n    const message = JSON.parse(event.data);\n\n    // connect response\n    if (message.signal === '__connect') {\n      this.analysis_id = message.load.analysis_id;\n    }\n\n    // processes\n    if (message.signal === '__process') {\n      const id = message.load.id;\n      const status = message.load.status;\n      this.onProcess_callbacks[id].map(cb => cb(status));\n    }\n\n    // normal message\n    if (this._on_callbacks_optimized === null) this.optimize_on_callbacks();\n    if (message.signal in this._on_callbacks_optimized) {\n      this._on_callbacks_optimized[message.signal].map(cb => cb(message.load));\n    }\n  }\n\n  optimize_on_callbacks() {\n    this._on_callbacks_optimized = {};\n    this.on_callbacks.forEach(({ signal, callback }) => {\n      if (typeof signal === 'string') {\n        if (!(signal in this._on_callbacks_optimized)) {\n          this._on_callbacks_optimized[signal] = [];\n        }\n        this._on_callbacks_optimized[signal].push(callback);\n      } else if (typeof signal === 'object') {\n        Object.keys(signal).forEach(signalName => {\n          const entryName = signal[signalName];\n          const filtered_callback = data => {\n            if (data.hasOwnProperty(entryName)) {\n              callback(data[entryName]);\n            }\n          };\n\n          if (!(signalName in this._on_callbacks_optimized)) {\n            this._on_callbacks_optimized[signalName] = [];\n          }\n\n          // only use the filtered callback if the entry was not empty\n          if (entryName) {\n            this._on_callbacks_optimized[signalName].push(filtered_callback);\n          } else {\n            this._on_callbacks_optimized[signalName].push(callback);\n          }\n        });\n      }\n    });\n  }\n\n  on(signal, callback) {\n    this.on_callbacks.push({ signal, callback });\n    this._on_callbacks_optimized = null;\n    return this;\n  }\n\n  emit(signalName, message) {\n    if (this.socket == null || this.socket.readyState !== this.socket.OPEN) {\n      setTimeout(() => this.emit(signalName, message), 5);\n      return this;\n    }\n    this.socket.send(JSON.stringify({ signal: signalName, load: message }));\n    return this;\n  }\n\n  onProcess(processID, callback) {\n    if (!(processID in this.onProcess_callbacks)) {\n      this.onProcess_callbacks[processID] = [];\n    }\n    this.onProcess_callbacks[processID].push(callback);\n    return this;\n  }\n}\n","import * as ui from './ui';\nimport { Connection } from './connection';\n\n// create a public interface\nif (typeof window !== 'undefined') {\n  window.Databench = { ui, Connection };\n}\nexport { ui, Connection };\n","\nclass UIElement {\n  constructor(node) {\n    this.node = node;\n    this.node.databench_ui = this;\n\n    this.action_name = UIElement.determine_action_name(node);\n    this.action_format = value => value;\n\n    this.wire_signal = { data: this.action_name };\n  }\n\n  static determine_action_name(node) {\n    // determine action name from HTML DOM\n    let action = null;\n\n    if (node.dataset.skipwire === 'true' ||\n      node.dataset.skipwire === 'TRUE' ||\n      node.dataset.skipwire === '1') {\n      return null;\n    }\n\n    if (node.dataset.action) {\n      action = node.dataset.action;\n    } else if (node.getAttribute('name')) {\n      action = node.getAttribute('name');\n    } else if (node.getAttribute('id')) {\n      action = node.getAttribute('id');\n    }\n\n    return action;\n  }\n}\n\nexport class Log extends UIElement {\n  constructor(node, consoleFnName = 'log', limit = 20, length_limit = 250) {\n    super(node);\n\n    this.consoleFnName = consoleFnName;\n    this.limit = limit;\n    this.length_limit = length_limit;\n    this._messages = [];\n\n    // more sensible default for this case\n    this.wire_signal = { log: null };\n\n    // bind methods\n    this.render = this.render.bind(this);\n    this.add = this.add.bind(this);\n\n    // capture events from frontend\n    const _consoleFnOriginal = console[consoleFnName];\n    console[consoleFnName] = message => {\n      this.add(message, 'frontend');\n      _consoleFnOriginal.apply(console, [message]);\n    };\n  }\n\n  render() {\n    while (this._messages.length > this.limit) this._messages.shift();\n\n    this.node.innerText = this._messages\n      .map(m => m.join(''))\n      .map(m => ((m.length > this.length_limit)\n                 ? `${m.substr(0, this.length_limit)} ...`\n                 : m))\n      .join('\\n');\n\n    return this;\n  }\n\n  add(message, source = 'unknown') {\n    const msg = typeof message === 'string' ? message : JSON.stringify(message);\n    const padded_source = ' '.repeat(Math.max(0, 8 - source.length)) + source;\n    this._messages.push([`${padded_source}: ${msg}`]);\n    this.render();\n    return this;\n  }\n\n  static wire(conn, id = 'log', source = 'backend', consoleFnName = 'log',\n              limit = 20, length_limit = 250) {\n    const node = document.getElementById(id);\n    if (node == null) return this;\n\n    console.log(`Wiring element id=${id}.`);\n    const l = new Log(node, consoleFnName, limit, length_limit);\n    conn.on(l.wire_signal, message => l.add(message, source));\n    return this;\n  }\n}\n\n\nexport class StatusLog extends UIElement {\n  constructor(node, formatter = StatusLog.default_alert) {\n    super(node);\n\n    this.formatter = formatter;\n    this._messages = new Map();\n\n    // to avoid confusion, void meaningless parent variable\n    this.wire_signal = null;\n\n    // bind methods\n    this.render = this.render.bind(this);\n    this.add = this.add.bind(this);\n  }\n\n  static default_alert(msg, count) {\n    const count_format = count <= 1 ? '' : `<b>(${count})</b> `;\n    return `<div class=\"alert alert-danger\">${count_format}${msg}</div>`;\n  }\n\n  render() {\n    const formatted = [...this._messages].map(([m, c]) => this.formatter(m, c));\n    this.node.innerHTML = formatted.join('\\n');\n    return this;\n  }\n\n  add(message) {\n    if (message == null) {\n      this._messages.clear();\n      return this;\n    }\n    const msg = typeof message === 'string' ? message : JSON.stringify(message);\n\n    if (this._messages.has(msg)) {\n      this._messages.set(msg, this._messages.get(msg) + 1);\n    } else {\n      this._messages.set(msg, 1);\n    }\n    this.render();\n    return this;\n  }\n\n  static wire(conn, id = 'ws-alerts', formatter = StatusLog.default_alert) {\n    const node = document.getElementById(id);\n    if (node == null) return;\n\n    console.log(`Wiring element id=${id}.`);\n    const l = new StatusLog(node, formatter);\n    conn.error_cb = l.add;\n  }\n}\n\n\nexport class Button extends UIElement {\n  constructor(node) {\n    super(node);\n\n    this.IDLE = 0;\n    this.ACTIVE = 2;\n\n    this.click_cb = (processID) => console.log(`click on ${this.node} with ${processID}`);\n    this._state = this.IDLE;\n\n    // bind methods\n    this.render = this.render.bind(this);\n    this.click = this.click.bind(this);\n    this.state = this.state.bind(this);\n\n    this.node.addEventListener('click', this.click, false);\n  }\n\n  render() {\n    switch (this._state) {\n      case this.ACTIVE:\n        this.node.classList.add('disabled');\n        break;\n      default:\n        this.node.classList.remove('disabled');\n    }\n    return this;\n  }\n\n  click() {\n    if (this._state !== this.IDLE) return this;\n\n    const processID = Math.floor(Math.random() * 0x100000);\n    this.click_cb(processID);\n    return this;\n  }\n\n  state(s) {\n    if (s !== this.IDLE && s !== this.ACTIVE) return this;\n\n    this._state = s;\n    this.render();\n    return this;\n  }\n\n  static wire(conn) {\n    Array.from(document.getElementsByTagName('BUTTON'))\n      .filter(node => node.databench_ui === undefined)\n      .forEach(node => {\n        const b = new Button(node);\n        console.log(`Wiring button ${node} to action ${b.action_name}.`);\n\n        // set up click callback\n        b.click_cb = (processID) => {\n          // set up process callback\n          conn.onProcess(processID, status => b.state(\n            // map process status to state\n            { start: b.ACTIVE, end: b.IDLE }[status]\n          ));\n\n          conn.emit(b.action_name, b.action_format({ __process_id: processID }));\n        };\n      });\n  }\n}\n\n\nexport class Text extends UIElement {\n  constructor(node) {\n    super(node);\n\n    this.format_fn = value => value;\n\n    // bind methods\n    this.value = this.value.bind(this);\n  }\n\n  value(v) {\n    // reading value\n    if (v === undefined) return this.node.innerHTML;\n\n    this.node.innerHTML = this.format_fn(v || '');\n    return this;\n  }\n\n  static wire(conn) {\n    [...Array.from(document.getElementsByTagName('SPAN')),\n     ...Array.from(document.getElementsByTagName('P')),\n     ...Array.from(document.getElementsByTagName('DIV')),\n     ...Array.from(document.getElementsByTagName('I')),\n     ...Array.from(document.getElementsByTagName('B'))]\n      .filter(node => node.databench_ui === undefined)\n      .filter(node => node.dataset.action !== undefined)\n      .filter(node => UIElement.determine_action_name(node) !== null)\n      .forEach(node => {\n        const t = new Text(node);\n        console.log(`Wiring text ${node} to action ${t.action_name}.`);\n\n        // handle events from backend\n        conn.on(t.wire_signal, message => t.value(message));\n      });\n  }\n}\n\n\nexport class TextInput extends UIElement {\n  constructor(node) {\n    super(node);\n\n    this.trigger_on_keyup = false;\n    this.format_fn = value => value;\n    this.change_cb = value => console.log(`change of ${this.node}: ${value}`);\n\n    // bind methods\n    this.change = this.change.bind(this);\n    this.keyup = this.keyup.bind(this);\n    this.value = this.value.bind(this);\n\n    this.node.addEventListener('change', this.change, false);\n    this.node.addEventListener('keyup', this.keyup, false);\n  }\n\n  change() {\n    return this.change_cb(this.action_format(this.value()));\n  }\n\n  keyup() {\n    if (this.trigger_on_keyup) this.change();\n  }\n\n  value(v) {\n    // reading value\n    if (v === undefined) return this.node.value;\n\n    this.node.value = this.format_fn(v || '');\n    return this;\n  }\n\n  static wire(conn) {\n    Array.from(document.getElementsByTagName('INPUT'))\n      .filter(node => node.databench_ui === undefined)\n      .filter(node => node.getAttribute('type') === 'text')\n      .forEach(node => {\n        const t = new TextInput(node);\n        console.log(`Wiring text input ${node} to action ${t.action_name}.`);\n\n        // handle events from frontend\n        t.change_cb = message => conn.emit(t.action_name, message);\n\n        // handle events from backend\n        conn.on(t.wire_signal, message => t.value(message));\n      });\n  }\n}\n\n\nexport class Slider extends UIElement {\n  constructor(node, label_node) {\n    super(node);\n\n    this.label_node = label_node;\n    this.label_html = label_node ? label_node.innerHTML : null;\n    this.change_cb = value => console.log(`slider value change: ${value}`);\n    this.value_to_slider = value => value;\n    this.slider_to_value = s => s;\n    this.format_fn = value => value;\n\n    // bind methods\n    this.render = this.render.bind(this);\n    this.value = this.value.bind(this);\n    this.change = this.change.bind(this);\n\n    this.node.addEventListener('input', this.render, false);\n    this.node.addEventListener('change', this.change, false);\n    this.render();\n  }\n\n  render() {\n    const v = this.value();\n    if (this.label_node) {\n      this.label_node.innerHTML = `${this.label_html} ${this.format_fn(v)}`;\n    }\n    return this;\n  }\n\n  value(v) {\n    // reading value\n    if (v === undefined) {\n      return this.slider_to_value(parseFloat(this.node.value));\n    }\n\n    const new_slider_value = this.value_to_slider(v);\n    if (this.node.value === new_slider_value) return this;\n\n    this.node.value = new_slider_value;\n    this.render();\n    return this;\n  }\n\n  change() {\n    return this.change_cb(this.action_format(this.value()));\n  }\n\n  static preprocess_labels() {\n    Array.from(document.getElementsByTagName('LABEL'))\n      .filter(label => label.htmlFor)\n      .forEach(label => {\n        const node = document.getElementById(label.htmlFor);\n        if (node) node.label = label;\n      });\n  }\n\n  static wire(conn) {\n    this.preprocess_labels();\n\n    Array.from(document.getElementsByTagName('INPUT'))\n      .filter(node => node.databench_ui === undefined)\n      .filter(node => node.getAttribute('type') === 'range')\n      .forEach(node => {\n        const slider = new Slider(node, node.label);\n        console.log(`Wiring slider ${node} to action ${slider.action_name}.`);\n\n        // handle events from frontend\n        slider.change_cb = message => conn.emit(slider.action_name, message);\n\n        // handle events from backend\n        conn.on(slider.wire_signal, message => slider.value(message));\n      });\n  }\n}\n\nexport function wire(connection) {\n  StatusLog.wire(connection);\n  Log.wire(connection);\n  Button.wire(connection);\n  TextInput.wire(connection);\n  Text.wire(connection);\n  Slider.wire(connection);\n  return connection;\n}\n","var _global = (function() { return this; })();\nvar nativeWebSocket = _global.WebSocket || _global.MozWebSocket;\nvar websocket_version = require('./version');\n\n\n/**\n * Expose a W3C WebSocket class with just one or two arguments.\n */\nfunction W3CWebSocket(uri, protocols) {\n\tvar native_instance;\n\n\tif (protocols) {\n\t\tnative_instance = new nativeWebSocket(uri, protocols);\n\t}\n\telse {\n\t\tnative_instance = new nativeWebSocket(uri);\n\t}\n\n\t/**\n\t * 'native_instance' is an instance of nativeWebSocket (the browser's WebSocket\n\t * class). Since it is an Object it will be returned as it is when creating an\n\t * instance of W3CWebSocket via 'new W3CWebSocket()'.\n\t *\n\t * ECMAScript 5: http://bclary.com/2004/11/07/#a-13.2.2\n\t */\n\treturn native_instance;\n}\n\n\n/**\n * Module exports.\n */\nmodule.exports = {\n    'w3cwebsocket' : nativeWebSocket ? W3CWebSocket : null,\n    'version'      : websocket_version\n};\n","module.exports = require('../package.json').version;\n","module.exports={\n  \"_args\": [\n    [\n      \"websocket@^1.0.22\",\n      \"/Users/svenkreiss/tech/databench\"\n    ]\n  ],\n  \"_from\": \"websocket@>=1.0.22 <2.0.0\",\n  \"_id\": \"websocket@1.0.23\",\n  \"_inCache\": true,\n  \"_installable\": true,\n  \"_location\": \"/websocket\",\n  \"_nodeVersion\": \"0.10.45\",\n  \"_npmOperationalInternal\": {\n    \"host\": \"packages-16-east.internal.npmjs.com\",\n    \"tmp\": \"tmp/websocket-1.0.23.tgz_1463625793005_0.4532310354989022\"\n  },\n  \"_npmUser\": {\n    \"email\": \"brian@worlize.com\",\n    \"name\": \"theturtle32\"\n  },\n  \"_npmVersion\": \"2.15.1\",\n  \"_phantomChildren\": {},\n  \"_requested\": {\n    \"name\": \"websocket\",\n    \"raw\": \"websocket@^1.0.22\",\n    \"rawSpec\": \"^1.0.22\",\n    \"scope\": null,\n    \"spec\": \">=1.0.22 <2.0.0\",\n    \"type\": \"range\"\n  },\n  \"_requiredBy\": [\n    \"/\"\n  ],\n  \"_resolved\": \"https://registry.npmjs.org/websocket/-/websocket-1.0.23.tgz\",\n  \"_shasum\": \"20de8ec4a7126b09465578cd5dbb29a9c296aac6\",\n  \"_shrinkwrap\": null,\n  \"_spec\": \"websocket@^1.0.22\",\n  \"_where\": \"/Users/svenkreiss/tech/databench\",\n  \"author\": {\n    \"email\": \"brian@worlize.com\",\n    \"name\": \"Brian McKelvey\",\n    \"url\": \"https://www.worlize.com/\"\n  },\n  \"browser\": \"lib/browser.js\",\n  \"bugs\": {\n    \"url\": \"https://github.com/theturtle32/WebSocket-Node/issues\"\n  },\n  \"config\": {\n    \"verbose\": false\n  },\n  \"contributors\": [\n    {\n      \"email\": \"ibc@aliax.net\",\n      \"name\": \"IÃ±aki Baz Castillo\",\n      \"url\": \"http://dev.sipdoc.net\"\n    }\n  ],\n  \"dependencies\": {\n    \"debug\": \"^2.2.0\",\n    \"nan\": \"^2.3.3\",\n    \"typedarray-to-buffer\": \"^3.1.2\",\n    \"yaeti\": \"^0.0.4\"\n  },\n  \"description\": \"Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.\",\n  \"devDependencies\": {\n    \"buffer-equal\": \"^0.0.1\",\n    \"faucet\": \"^0.0.1\",\n    \"gulp\": \"git+https://github.com/gulpjs/gulp.git#4.0\",\n    \"gulp-jshint\": \"^1.11.2\",\n    \"jshint-stylish\": \"^1.0.2\",\n    \"tape\": \"^4.0.1\"\n  },\n  \"directories\": {\n    \"lib\": \"./lib\"\n  },\n  \"dist\": {\n    \"shasum\": \"20de8ec4a7126b09465578cd5dbb29a9c296aac6\",\n    \"tarball\": \"https://registry.npmjs.org/websocket/-/websocket-1.0.23.tgz\"\n  },\n  \"engines\": {\n    \"node\": \">=0.8.0\"\n  },\n  \"gitHead\": \"ba2fa7e9676c456bcfb12ad160655319af66faed\",\n  \"homepage\": \"https://github.com/theturtle32/WebSocket-Node\",\n  \"keywords\": [\n    \"websocket\",\n    \"websockets\",\n    \"socket\",\n    \"networking\",\n    \"comet\",\n    \"push\",\n    \"RFC-6455\",\n    \"realtime\",\n    \"server\",\n    \"client\"\n  ],\n  \"license\": \"Apache-2.0\",\n  \"main\": \"index\",\n  \"maintainers\": [\n    {\n      \"email\": \"brian@worlize.com\",\n      \"name\": \"theturtle32\"\n    }\n  ],\n  \"name\": \"websocket\",\n  \"optionalDependencies\": {},\n  \"readme\": \"ERROR: No README data found!\",\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"git+https://github.com/theturtle32/WebSocket-Node.git\"\n  },\n  \"scripts\": {\n    \"gulp\": \"gulp\",\n    \"install\": \"(node-gyp rebuild 2> builderror.log) || (exit 0)\",\n    \"test\": \"faucet test/unit\"\n  },\n  \"version\": \"1.0.23\"\n}\n"]}
{"version":3,"sources":["node_modules/browser-pack/_prelude.js","js/src/connection.js","js/src/main.js","js/src/ui.js","node_modules/websocket/lib/browser.js","node_modules/websocket/lib/version.js","node_modules/websocket/package.json"],"names":[],"mappings":"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A;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"databench.js","sourceRoot":"/source/","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","if (typeof WebSocket === 'undefined') {\n    var WebSocket = require('websocket').w3cwebsocket;\n}\n\nexport class Connection {\n    constructor(analysis_id=null, ws_url=null) {\n        this.analysis_id = analysis_id;\n        this.ws_url = ws_url ? ws_url : Connection.guess_ws_url();\n\n        this.error_cb = (msg) => {\n            if (msg != null)\n                return console.log(`connection error: ${msg}`);\n        }\n        this.on_callbacks = [];\n        this._on_callbacks_optimized = null;\n        this.onProcess_callbacks = {};\n\n        this.ws_reconnect_attempt = 0;\n        this.ws_reconnect_delay = 100.0;\n\n        this.socket = null;\n        this.socket_check_open = null;\n\n        // bind methods\n        this.connect = this.connect.bind(this);\n        this.ws_check_open = this.ws_check_open.bind(this);\n        this.ws_onopen = this.ws_onopen.bind(this);\n        this.ws_onclose = this.ws_onclose.bind(this);\n        this.ws_onmessage = this.ws_onmessage.bind(this);\n        this.optimize_on_callbacks = this.optimize_on_callbacks.bind(this);\n        this.on = this.on.bind(this);\n        this.emit = this.emit.bind(this);\n        this.onProcess = this.onProcess.bind(this);\n    }\n\n    static guess_ws_url() {\n        var ws_protocol = 'ws';\n        if (location.origin.startsWith('https://')) ws_protocol = 'wss';\n\n        let path = location.pathname.substring(0, location.pathname.lastIndexOf('/'));\n        return `${ws_protocol}://${document.domain}:${location.port}${path}/ws`;\n    }\n\n    connect() {\n        this.socket = new WebSocket(this.ws_url);\n\n        this.socket_check_open = setInterval(this.ws_check_open, 2000);\n        this.socket.onopen = this.ws_onopen;\n        this.socket.onclose = this.ws_onclose;\n        this.socket.onmessage = this.ws_onmessage;\n        return this;\n    }\n\n    ws_check_open() {\n        if (this.socket.readyState == this.socket.CONNECTING) {\n            return;\n        }\n        if (this.socket.readyState != this.socket.OPEN) {\n            this.error_cb(\n                'Connection could not be opened. '+\n                'Please <a href=\"javascript:location.reload(true);\" '+\n                'class=\"alert-link\">reload</a> this page to try again.'\n            );\n        }\n        clearInterval(this.socket_check_open);\n    }\n\n    ws_onopen() {\n        this.ws_reconnect_attempt = 0;\n        this.ws_reconnect_delay = 100.0;\n        this.error_cb();  // clear errors\n        this.socket.send(JSON.stringify({'__connect': this.analysis_id}));\n    }\n\n    ws_onclose() {\n        clearInterval(this.socket_check_open);\n\n        this.ws_reconnect_attempt += 1;\n        this.ws_reconnect_delay *= 2;\n\n        if (this.ws_reconnect_attempt > 3) {\n            this.error_cb(\n                'Connection closed. '+\n                'Please <a href=\"javascript:location.reload(true);\" '+\n                'class=\"alert-link\">reload</a> this page to reconnect.'\n            );\n            return;\n        }\n\n        let actual_delay = 0.7 * this.ws_reconnect_delay + 0.3 * Math.random() * this.ws_reconnect_delay;\n        console.log(`WebSocket reconnect attempt ${this.ws_reconnect_attempt} in ${actual_delay.toFixed(0)}ms.`);\n        setTimeout(this.connect, actual_delay);\n    }\n\n    ws_onmessage(event) {\n        let message = JSON.parse(event.data);\n\n        // connect response\n        if (message.signal == '__connect') {\n            this.analysis_id = message.load.analysis_id;\n        }\n\n        // processes\n        if (message.signal == '__process') {\n            let id = message.load.id;\n            let status = message.load.status;\n            this.onProcess_callbacks[id].map(cb => cb(status));\n        }\n\n        // normal message\n        if (this._on_callbacks_optimized === null)\n            this.optimize_on_callbacks();\n        if (message.signal in this._on_callbacks_optimized) {\n            this._on_callbacks_optimized[message.signal].map(\n                cb => cb(message.load)\n            );\n        }\n    }\n\n    optimize_on_callbacks() {\n        this._on_callbacks_optimized = {};\n        this.on_callbacks.map(({signal, callback}) => {\n            if (typeof signal === \"string\") {\n                if (!(signal in this._on_callbacks_optimized))\n                    this._on_callbacks_optimized[signal] = [];\n                this._on_callbacks_optimized[signal].push(callback);\n            }else if(typeof signal === \"object\") {\n                for (let signalName in signal) {\n                    let entryName = signal[signalName];\n                    let filtered_callback = data => {\n                        if (data.hasOwnProperty(entryName)) {\n                            callback(data[entryName]);\n                        }\n                    };\n\n                    if (!(signalName in this._on_callbacks_optimized))\n                        this._on_callbacks_optimized[signalName] = [];\n\n                    // only use the filtered callback if the entry was not empty\n                    if (entryName) {\n                        this._on_callbacks_optimized[signalName].push(filtered_callback);\n                    } else {\n                        this._on_callbacks_optimized[signalName].push(callback);\n                    }\n                }\n            }\n        });\n    }\n\n    on(signal, callback) {\n        this.on_callbacks.push({signal, callback});\n        this._on_callbacks_optimized = null;\n        return this;\n    }\n\n    emit(signalName, message) {\n        if (this.socket == null  ||  this.socket.readyState != this.socket.OPEN) {\n            setTimeout(() => this.emit(signalName, message), 5);\n            return;\n        }\n        this.socket.send(JSON.stringify({'signal':signalName, 'load':message}));\n        return this;\n    }\n\n    onProcess(processID, callback) {\n        if (!(processID in this.onProcess_callbacks))\n            this.onProcess_callbacks[processID] = [];\n        this.onProcess_callbacks[processID].push(callback);\n        return this;\n    }\n}\n","import * as ui from './ui';\nimport { Connection } from './connection';\n\n// create a public interface\nif (typeof window !== 'undefined') {\n\twindow.Databench = { ui, Connection };\n}\nexport { ui, Connection };\n","\nexport function wire(conn) {\n    StatusLog.wire(d);\n    Log.wire(d);\n    Button.wire(d);\n    TextInput.wire(d);\n    Text.wire(d);\n    Slider.wire(d);\n    return conn;\n}\n\nclass UIElement {\n    constructor(node) {\n        this.node = node;\n        this.node.databench_ui = this;\n\n        this.action_name = UIElement.determine_action_name(node);\n        this.action_format = value => value;\n\n        this.wire_signal = {data: this.action_name};\n    }\n\n    static determine_action_name(node) {\n        // determine action name from HTML DOM\n        let action = null;\n\n        if (node.dataset.action) {\n            action = node.dataset.action;\n        } else if (node.getAttribute('name')) {\n            action = node.getAttribute('name');\n        }\n\n        return action;\n    }\n}\n\nexport class Log extends UIElement {\n    constructor(node, consoleFnName='log', limit=20, length_limit=250) {\n        super(node);\n\n        this.consoleFnName = consoleFnName;\n        this.limit = limit;\n        this.length_limit = length_limit;\n        this._messages = [];\n\n        // more sensible default for this case\n        this.wire_signal = {log: null};\n\n        // bind methods\n        this.render = this.render.bind(this);\n        this.add = this.add.bind(this);\n\n        // capture events from frontend\n        let _consoleFnOriginal = console[consoleFnName];\n        console[consoleFnName] = (message) => {\n            this.add(message, 'frontend');\n            _consoleFnOriginal.apply(console, [message]);\n        }\n    }\n\n    render() {\n        while(this._messages.length > this.limit) this._messages.shift();\n\n        this.node.innerText = this._messages\n            .map((m) => m.join(''))\n            .map((m) => ((m.length > this.length_limit)\n                         ? m.substr(0, this.length_limit)+'...'\n                         : m))\n            .join('\\n');\n\n        return this;\n    }\n\n    add(message, source='unknown') {\n        if (typeof message != \"string\") {\n            message = JSON.stringify(message);\n        }\n\n        let padded_source = ' '.repeat(Math.max(0, 8 - source.length)) + source;\n        this._messages.push([`${padded_source}: ${message}`]);\n        this.render();\n        return this;\n    }\n\n    static wire(conn, id='log', source='backend', consoleFnName='log', limit=20, length_limit=250) {\n        let node = document.getElementById(id);\n        if (node == null) return;\n\n        console.log(`Wiring element id=${id}.`);\n        let l = new Log(node, consoleFnName, limit, length_limit);\n        conn.on(l.wire_signal, message => l.add(message, source));\n        return this;\n    }\n};\n\n\nexport class StatusLog extends UIElement {\n    constructor(node, formatter=StatusLog.default_alert) {\n        super(node);\n\n        this.formatter = formatter;\n        this._messages = new Map();\n\n        // to avoid confusion, void meaningless parent variable\n        this.wire_signal = null;\n\n        // bind methods\n        this.render = this.render.bind(this);\n        this.add = this.add.bind(this);\n    }\n\n    static default_alert(msg, c) {\n        let c_format = c <= 1 ? '' : `<b>(${c})</b> `;\n        return `<div class=\"alert alert-danger\">${c_format}${msg}</div>`;\n    }\n\n    render() {\n        let formatted = [...this._messages].map(([m, c]) => this.formatter(m, c));\n        this.node.innerHTML = formatted.join('\\n');\n        return this;\n    }\n\n    add(msg) {\n        if (msg == null) {\n            this._messages.clear();\n            return;\n        }\n        if (typeof msg != \"string\") {\n            msg = JSON.stringify(msg);\n        }\n\n        if (this._messages.has(msg)) {\n            this._messages.set(msg, this._messages.get(msg) + 1);\n        } else {\n            this._messages.set(msg, 1);\n        }\n        this.render();\n        return this;\n    }\n\n    static wire(conn, id='ws-alerts', formatter=StatusLog.default_alert) {\n        let node = document.getElementById(id);\n        if (node == null) return;\n\n        console.log(`Wiring element id=${id}.`);\n        let l = new StatusLog(node, formatter);\n        conn.error_cb = l.add;\n    }\n};\n\n\nexport class Button extends UIElement {\n    constructor(node) {\n        super(node);\n\n        this.IDLE = 0;\n        this.ACTIVE = 2;\n\n        this.click_cb = (processID) => console.log(`click on ${this.node} with ${processID}`);\n        this._state = this.IDLE;\n\n        // bind methods\n        this.render = this.render.bind(this);\n        this.click = this.click.bind(this);\n        this.state = this.state.bind(this);\n\n        this.node.addEventListener('click', this.click, false);\n    }\n\n    render() {\n        switch (this._state) {\n            case this.ACTIVE:\n                this.node.classList.add('disabled');\n                break;\n            default:\n                this.node.classList.remove('disabled');\n        }\n        return this;\n    }\n\n    click() {\n        if (this._state != this.IDLE) return this;\n\n        let processID = Math.floor(Math.random() * 0x100000);\n        this.click_cb(processID);\n        return this;\n    }\n\n    state(s) {\n        if (s != this.IDLE && s != this.ACTIVE) return this;\n\n        this._state = s;\n        this.render();\n        return this;\n    }\n\n    static wire(conn) {\n        Array.from(document.getElementsByTagName('BUTTON'))\n            .filter(node => node.databench_ui === undefined)\n            .map(node => {\n                let b = new Button(node);\n                console.log(`Wiring button ${node} to action ${b.action_name}.`);\n\n                // set up click callback\n                b.click_cb = (processID) => {\n                    // set up process callback\n                    conn.onProcess(processID, status => b.state(\n                        // map process status to state\n                        {start: b.ACTIVE, end: b.IDLE}[status]\n                    ));\n\n                    conn.emit(b.action_name,\n                              b.action_format({__process_id: processID}));\n                };\n            });\n    }\n}\n\n\nexport class Text extends UIElement {\n    constructor(node) {\n        super(node);\n\n        this.format_fn = value => value;\n\n        // bind methods\n        this.value = this.value.bind(this);\n    }\n\n    value(v) {\n        this.node.innerHTML = this.format_fn(v);\n        return this;\n    }\n\n    static wire(conn) {\n        [...Array.from(document.getElementsByTagName('SPAN')),\n         ...Array.from(document.getElementsByTagName('P')),\n         ...Array.from(document.getElementsByTagName('DIV')),\n         ...Array.from(document.getElementsByTagName('I')),\n         ...Array.from(document.getElementsByTagName('B'))]\n            .filter(node => node.databench_ui === undefined)\n            .filter(node => UIElement.determine_action_name(node) !== null)\n            .map(node => {\n                let t = new Text(node);\n                console.log(`Wiring text ${node} to action ${t.action_name}.`);\n\n                // handle events from backend\n                conn.on(t.wire_signal, message => t.value(message));\n            });\n    }\n}\n\n\nexport class TextInput extends UIElement {\n    constructor(node) {\n        super(node);\n\n        this.format_fn = value => value;\n        this.change_cb = value => console.log(`change of ${this.node}: ${value}`);\n\n        // bind methods\n        this.change = this.change.bind(this);\n        this.value = this.value.bind(this);\n\n        this.node.addEventListener('change', this.change, false);\n    }\n\n    change() {\n        return this.change_cb(this.action_format(this.value()));\n    }\n\n    value(v) {\n        if (!v) {\n            // reading value\n            return this.node.value;\n        }\n\n        this.node.value = this.format_fn(v);\n        return this;\n    }\n\n    static wire(conn) {\n        Array.from(document.getElementsByTagName('INPUT'))\n            .filter(node => node.databench_ui === undefined)\n            .filter(node => node.getAttribute('type') == 'text')\n            .map(node => {\n                let t = new TextInput(node);\n                console.log(`Wiring text input ${node} to action ${t.action_name}.`);\n\n                // handle events from frontend\n                t.change_cb = message => conn.emit(t.action_name, message);\n\n                // handle events from backend\n                conn.on(t.wire_signal, message => t.value(message));\n            });\n    }\n}\n\n\nexport class Slider extends UIElement {\n    constructor(node, label_node) {\n        super(node);\n\n        this.label_node = label_node;\n        this.label_html = label_node ? label_node.innerHTML : null;\n        this.change_cb = value => console.log(`slider value change: ${value}`);\n        this._v_to_slider = value => value;\n        this._slider_to_v = s => s;\n        this._v_repr = v => v;\n\n        // bind methods\n        this.v_to_slider = this.v_to_slider.bind(this);\n        this.slider_to_v = this.slider_to_v.bind(this);\n        this.v_repr = this.v_repr.bind(this);\n        this.render = this.render.bind(this);\n        this.value = this.value.bind(this);\n        this.change = this.change.bind(this);\n\n        this.node.addEventListener('input', this.render, false);\n        this.node.addEventListener('change', this.change, false);\n        this.render();\n    }\n\n    v_to_slider(fn) {\n        this._v_to_slider = fn;\n        return this;\n    }\n\n    slider_to_v(fn) {\n        this._slider_to_v = fn;\n        return this;\n    }\n\n    v_repr(fn) {\n        this._v_repr = fn;\n        this.render();\n        return this;\n    }\n\n    render() {\n        let v = this.value();\n        if (this.label_node) {\n            this.label_node.innerHTML = `${this.label_html} ${this._v_repr(v)}`;\n        }\n        return this;\n    }\n\n    value(v) {\n        if (!v) {\n            // reading value\n            return this._slider_to_v(parseFloat(this.node.value));\n        }\n\n        let new_slider_value = this._v_to_slider(v);\n        if (this.node.value == new_slider_value) return this;\n\n        this.node.value = new_slider_value;\n        this.render();\n        return this;\n    }\n\n    change() {\n        return this.change_cb(this.action_format(this.value()));\n    }\n\n    static preprocess_labels() {\n        Array.from(document.getElementsByTagName('LABEL'))\n            .filter(label => label.htmlFor)\n            .map(label => {\n                let node = document.getElementsByName(label.htmlFor)[0];\n                if (node) node.label = label;\n            });\n    }\n\n    static wire(conn) {\n        this.preprocess_labels();\n\n        Array.from(document.getElementsByTagName('INPUT'))\n            .filter(node => node.databench_ui === undefined)\n            .filter(node => node.getAttribute('type') == 'range')\n            .map(node => {\n                let s = new Slider(node, node.label);\n                console.log(`Wiring slider ${node} to action ${s.action_name}.`);\n\n                // handle events from frontend\n                s.change_cb = message => conn.emit(s.action_name, message);\n\n                // handle events from backend\n                conn.on(s.wire_signal, message => s.value(message));\n            });\n    }\n}\n","var _global = (function() { return this; })();\nvar nativeWebSocket = _global.WebSocket || _global.MozWebSocket;\nvar websocket_version = require('./version');\n\n\n/**\n * Expose a W3C WebSocket class with just one or two arguments.\n */\nfunction W3CWebSocket(uri, protocols) {\n\tvar native_instance;\n\n\tif (protocols) {\n\t\tnative_instance = new nativeWebSocket(uri, protocols);\n\t}\n\telse {\n\t\tnative_instance = new nativeWebSocket(uri);\n\t}\n\n\t/**\n\t * 'native_instance' is an instance of nativeWebSocket (the browser's WebSocket\n\t * class). Since it is an Object it will be returned as it is when creating an\n\t * instance of W3CWebSocket via 'new W3CWebSocket()'.\n\t *\n\t * ECMAScript 5: http://bclary.com/2004/11/07/#a-13.2.2\n\t */\n\treturn native_instance;\n}\n\n\n/**\n * Module exports.\n */\nmodule.exports = {\n    'w3cwebsocket' : nativeWebSocket ? W3CWebSocket : null,\n    'version'      : websocket_version\n};\n","module.exports = require('../package.json').version;\n","module.exports={\n  \"_args\": [\n    [\n      \"websocket@^1.0.22\",\n      \"/Users/svenkreiss/tech/databench\"\n    ]\n  ],\n  \"_from\": \"websocket@>=1.0.22 <2.0.0\",\n  \"_id\": \"websocket@1.0.22\",\n  \"_inCache\": true,\n  \"_installable\": true,\n  \"_location\": \"/websocket\",\n  \"_nodeVersion\": \"3.3.1\",\n  \"_npmUser\": {\n    \"email\": \"brian@worlize.com\",\n    \"name\": \"theturtle32\"\n  },\n  \"_npmVersion\": \"2.14.3\",\n  \"_phantomChildren\": {},\n  \"_requested\": {\n    \"name\": \"websocket\",\n    \"raw\": \"websocket@^1.0.22\",\n    \"rawSpec\": \"^1.0.22\",\n    \"scope\": null,\n    \"spec\": \">=1.0.22 <2.0.0\",\n    \"type\": \"range\"\n  },\n  \"_requiredBy\": [\n    \"/\"\n  ],\n  \"_resolved\": \"https://registry.npmjs.org/websocket/-/websocket-1.0.22.tgz\",\n  \"_shasum\": \"8c33e3449f879aaf518297c9744cebf812b9e3d8\",\n  \"_shrinkwrap\": null,\n  \"_spec\": \"websocket@^1.0.22\",\n  \"_where\": \"/Users/svenkreiss/tech/databench\",\n  \"author\": {\n    \"email\": \"brian@worlize.com\",\n    \"name\": \"Brian McKelvey\",\n    \"url\": \"https://www.worlize.com/\"\n  },\n  \"browser\": \"lib/browser.js\",\n  \"bugs\": {\n    \"url\": \"https://github.com/theturtle32/WebSocket-Node/issues\"\n  },\n  \"config\": {\n    \"verbose\": false\n  },\n  \"contributors\": [\n    {\n      \"email\": \"ibc@aliax.net\",\n      \"name\": \"IÃ±aki Baz Castillo\",\n      \"url\": \"http://dev.sipdoc.net\"\n    }\n  ],\n  \"dependencies\": {\n    \"debug\": \"~2.2.0\",\n    \"nan\": \"~2.0.5\",\n    \"typedarray-to-buffer\": \"~3.0.3\",\n    \"yaeti\": \"~0.0.4\"\n  },\n  \"description\": \"Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.\",\n  \"devDependencies\": {\n    \"buffer-equal\": \"^0.0.1\",\n    \"faucet\": \"^0.0.1\",\n    \"gulp\": \"git+https://github.com/gulpjs/gulp.git#4.0\",\n    \"gulp-jshint\": \"^1.11.2\",\n    \"jshint-stylish\": \"^1.0.2\",\n    \"tape\": \"^4.0.1\"\n  },\n  \"directories\": {\n    \"lib\": \"./lib\"\n  },\n  \"dist\": {\n    \"shasum\": \"8c33e3449f879aaf518297c9744cebf812b9e3d8\",\n    \"tarball\": \"https://registry.npmjs.org/websocket/-/websocket-1.0.22.tgz\"\n  },\n  \"engines\": {\n    \"node\": \">=0.8.0\"\n  },\n  \"gitHead\": \"19108bbfd7d94a5cd02dbff3495eafee9e901ca4\",\n  \"homepage\": \"https://github.com/theturtle32/WebSocket-Node\",\n  \"keywords\": [\n    \"websocket\",\n    \"websockets\",\n    \"socket\",\n    \"networking\",\n    \"comet\",\n    \"push\",\n    \"RFC-6455\",\n    \"realtime\",\n    \"server\",\n    \"client\"\n  ],\n  \"license\": \"Apache-2.0\",\n  \"main\": \"index\",\n  \"maintainers\": [\n    {\n      \"email\": \"brian@worlize.com\",\n      \"name\": \"theturtle32\"\n    }\n  ],\n  \"name\": \"websocket\",\n  \"optionalDependencies\": {},\n  \"readme\": \"ERROR: No README data found!\",\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"git+https://github.com/theturtle32/WebSocket-Node.git\"\n  },\n  \"scripts\": {\n    \"gulp\": \"gulp\",\n    \"install\": \"(node-gyp rebuild 2> builderror.log) || (exit 0)\",\n    \"test\": \"faucet test/unit\"\n  },\n  \"version\": \"1.0.22\"\n}\n"]}